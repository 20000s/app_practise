!function(){var t;try{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function n(t){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function o(t,e,n){return(o=i()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&r(o,n.prototype),o}).apply(null,arguments)}function a(t){return(a=function(t){if(null===t||(e=t,-1===Function.toString.call(e).indexOf("[native code]")))return t;var e;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");function i(){return o(t,arguments,n(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),r(i,t)})(t)}var u=window.encodeURIComponent,c=location.origin||location.protocol+"//"+location.host,l="https://open.work.weixin.qq.com",p=l+"/wwopen/openData/frame/index#origin="+u(c),f="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),s=[];function d(t){s.unshift({level:2,msg:t})}function h(t){s.unshift({level:4,msg:t}),v()}function v(){0!==s.length&&(function(t,e){var n=new XMLHttpRequest;"withCredentials"in n||(n=new XDomainRequest);for(var r=[],i=e.length,o=0;o<i;o++)r.push(["msg["+o+"]="+u(e[o].msg),"level["+o+"]="+e[o].level].join("&"));r.push("count="+i),n.open("POST",t),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send(r.join("&"))}("https://aegis.qq.com/collect?id=LsKWKztteVKOjNJGsl&from="+c+"&sessionId="+f+"&version="+u("wwopendata.js@210224-173244-188"),s.reverse()),s=[])}var y={};function m(t,e){y.hasOwnProperty(t)||(y[t]=[]),y[t].push(e)}function g(t,e){if(y.hasOwnProperty(t)){var n=y[t],r=n.indexOf(e);r>=0&&n.splice(r,1)}}function w(t,e,n){if(void 0===n&&(n=!1),y.hasOwnProperty(t))if(n){var r={type:t,detail:e};y[t].forEach((function(t){try{t(r)}catch(t){}}))}else w(t,e,!0)}function b(t,e){return function(){try{return e.apply(this,arguments)}catch(e){S(e,t),w("error",e)}}}t={captureException:S};var _=O((function(){}),d),x=O((function(){}),h);function E(t){d(t),v()}function S(t,e){h("["+e+"] "+C(t))}function O(t,e){return function(){for(var n=[],r=0,i=arguments.length;r<i;r++)n.push(A(arguments[r]));e(n.join(" ")),t.apply(void 0,arguments)}}function A(t){return t?"object"!=typeof t?t:"string"==typeof t.stack?C(x):JSON.stringify(t):t}function C(t){return t.name+" "+t.message+" "+t.stack}var D=window.wx,k=window.WeixinSandBox,T=null==k?void 0:k.__secret__;_("[sandbox.version] "+(k?k.__version__||"legacy":"missing")),"__WEIXIN_SANDBOX_SECRET_VALUE__"!==T&&E("SandBox secret mismatch");var R,F,M=null==k?void 0:k.protected,W=null==k?void 0:k.singleton,P=(null==W?void 0:W.call)||Function.prototype.call.bind(Function.prototype.call),j=function(t){return t&&P(q,N,t)},q=ot(M,"Function.prototype.bind"),N=ot(M,"Function.prototype.call"),I=(ot(M,"Object.create"),ot(M,"Object.defineProperty")),L=ot(W,"setTimeout","direct"),J=j(ot(M,"Object.prototype.hasOwnProperty")),H=j(ot(M,"Array.prototype.push")),U=j(ot(M,"Array.prototype.forEach")),z=j(ot(M,"String.prototype.indexOf")),K=j(ot(M,"String.prototype.slice")),B=(ot(W,"Image","direct"),j(ot(M,"Image.prototype.src","set"))||j(ot(M,"HTMLImageElement.prototype.src","set"))||function(t,e){t.src=e}),V=j(ot(M,"HTMLIframeElement.prototype.contentWindow","get"))||function(t){return t.contentWindow},X=j(ot(M,"HTMLIframeElement.prototype.contentDocument","get"))||function(t){return t.contentDocument},G=j(ot(M,"EventTarget.prototype.addEventListener"))||function(t,e,n){t.addEventListener(e,n)},Q=j(ot(M,"CanvasRenderingContext2D.prototype.fillText")),Y=j(ot(M,"CanvasRenderingContext2D.prototype.drawImage")),Z=j(ot(M,"CanvasRenderingContext2D.prototype.strokeText")),$=j(ot(M,"CanvasRenderingContext2D.prototype.measureText")),tt=ot(W,"WeakMap","direct"),et=j(ot(M,"WeakMap.prototype.get")),nt=j(ot(M,"WeakMap.prototype.set")),rt=j(ot(M,"Element.prototype.attachShadow")),it=j(ot(M,"Node.prototype.textContent","set"));function ot(t,e,n){var r,i,o,a,u;void 0===n&&(n="value");var c=(null==M||null==(r=M.String)?void 0:r.prototype.split.value)||window.String.prototype.split,l=(null==M||null==(i=M.Array)?void 0:i.prototype.pop.value)||window.Array.prototype.pop,p=(null==M||null==(o=M.Array)?void 0:o.prototype.forEach.value)||window.Array.prototype.forEach,f=(null==M||null==(a=M.Object)?void 0:a.getOwnPropertyDescriptor.value)||Object.getOwnPropertyDescriptor,s=P(c,e,"."),d=P(l,s),h=t,v=window;if(P(p,s,(function(t){h&&(h=h[t]),v&&(v=v[t])})),h&&h[d]){if(h=h[d],"direct"===n)return h;if(h[n])return h[n]}if(v)return"direct"===n||"value"===n?v[d]:null==(u=f(v,d))?void 0:u[n]}function at(t,e){if(J(t,e))return t[e]}function ut(t,e,n){I(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}(null==(R=window.crypto)?void 0:R.subtle)||null==(F=window.crypto)||F.webkitSubtle;var ct={},lt=1,pt={};function ft(t,e){var n=""+lt++;ut(ct,n,e),function(t,e){var n=Math.random();_("[fetchData] begin #"+e+" ("+n+")"),D.invoke("wwapp.getOpenData",{callbackId:e,data:JSON.stringify({rand:""+n,items:t})},(function(r){"wwapp.getOpenData:ok"!==(r.errMsg||r.err_msg||r.errmsg)?(x("[fetchData] wwapp.getOpenData fail #"+e,t,r),w("error",{errMsg:"wwapp.getOpenData:fail",rand:n})):_("[fetchData] wwapp.getOpenData res #"+e)}))}(t,n)}function st(t,e,n){return at(pt,dt(t,e,n))}function dt(t,e,n){return t+"::"+e+"::"+(n||"")}var ht=new Image,vt=!1,yt=null,mt=[];function gt(){var t=mt;mt=[],U(t,(function(t){t(yt)}))}G(ht,"load",(function(){vt=!0,L(gt,1)})),G(ht,"error",(function(){yt=new Error("Failed to load crossorigin image"),L(gt,1)})),B(ht,"https://wwcdn.weixin.qq.com/node/wework/images/1x1-00000000.91e42db1c6.png");var wt=String.fromCharCode(8204),bt=String.fromCharCode(8205),_t=String.fromCharCode(8203),xt=[String.fromCharCode(8206),String.fromCharCode(8207),wt,bt,_t],Et={},St=0;function Ot(t){var e=at(t,"encrypt_token");if(e)return e;var n=at(t,"data"),r=at(t,"encrypt_text_data");if(n&&r){for(var i=(St++).toString(5),o="",a=0,u=i.length;a<u;a++)o+=xt[i[a]];var c="\ufeff"+r+o+"\ufeff";return ut(Et,c,n),ut(t,"encrypt_token",c),c}}function At(t){var e=z(t,"\ufeff",0);if(-1===e)return t;for(var n=K(t,0,e);-1!==e;){var r=z(t,"\ufeff",e+1);if(-1===r)break;var i=at(Et,K(t,e,r+1));i?(n+=i,e=r+1):(n+=K(t,e,r),e=r)}return n+K(t,e)}var Ct=tt&&new tt,Dt=!1,kt=!1;function Tt(t){et(Ct,t)||(kt||Y(t,ht,0,0),nt(Ct,t,!0))}function Rt(t,e){var n=null;try{n=X(t)}catch(t){}if(null!==n)throw new Error("Missing cross origin");V(t).postMessage(e,l)}var Ft,Mt,Wt=function(){function t(){var t=this;this.iframe=document.createElement("iframe"),this.state="loading",this.queue=[],this.timeout=null,this.iframe.onload=b("MainFrame.onload",(function(){_("[MainFrame] onload"),t.state="ready",t.fetchData()})),this.iframe.onerror=function(e){S((null==e?void 0:e.error)||new Error("MainFrame load error"),"MainFrame.onerror"),t.state="error"},this.iframe.style.display="none",this.iframe.referrerPolicy="origin",this.iframe.src=p}var e=t.prototype;return e.enqueueFetch=function(t){var e=this;this.queue.push(t),this.timeout||(this.timeout=setTimeout(b("MainFrame.timeout",(function(){"ready"===e.state&&e.fetchData()})),20))},e.fetchData=function(){var t,e,n={},r=[];this.queue.forEach((function(t){var e=t.type+"::"+t.id+"::"+(t.corpid||"");n[e]||(n[e]=!0,r.push(t))})),r.length&&(this.timeout=null,this.queue=[],_("[MainFrame] fetchData"),t=this.iframe,ft(e=r,(function(n){if(n)w("error",n);else{var r=[];U(e,(function(t){var e=st(t.type,t.id,t.corpid);e&&H(r,e)})),Rt(t,{type:"data",items:r})}})))},t}(),Pt=["fontFamily","fontSize","fontWeight","fontStyle","fontVariant","fontStretch","fontSizeAdjust","color","cursor"],jt=function(){function t(t,e){this.renderType="emtpy",this.renderEl=null,this.container=t,this.mainFrame=e}var e=t.prototype;return e.update=function(){var t=this.getItem();if(!t.type||!t.id)return this.renderEmpty();this.renderText(t)},e.renderEmpty=function(){this.setChild("empty")},e.renderText=function(t){var e=this;if("frame"!==this.renderType||"error"===this.loadState){var n=document.createElement("iframe");n.onload=b("Frame.onload",(function(){e.renderEl===n&&(e.loadState="ready",e.notifyUpdate())})),n.onerror=function(t){e.renderEl===n&&(S((null==t?void 0:t.error)||new Error("Frame load error"),"Frame.onerror"),e.loadState="error")};var r=u(t.type+"::"+t.id+"::"+(t.corpid||""));n.frameBorder=0,n.referrerPolicy="origin",n.src=p+"&init="+r,this.loadState="loading",this.setChild("frame",n)}this.mainFrame.enqueueFetch(t),"ready"===this.loadState&&this.notifyUpdate(t)},e.setChild=function(t,e){void 0===e&&(e=null);for(var n=this.container;n.firstChild;)n.removeChild(n.firstChild);e&&n.appendChild(e),this.renderEl=e,this.renderType=t},e.getItem=function(){return{type:this.container.getAttribute("type"),id:this.container.getAttribute("openid"),corpid:this.container.getAttribute("corpid")}},e.notifyUpdate=function(t){if(void 0===t&&(t=this.getItem()),t.type&&t.id){var e={},n=getComputedStyle(this.container);Pt.forEach((function(t){e[t]=n[t]})),Rt(this.renderEl,JSON.stringify({type:"update",item:t,style:e}))}},t}();function qt(t){t&&(t.__WW_OPENDATA_RENDER__||(t.__WW_OPENDATA_RENDER__=new jt(t,Ft)),t.__WW_OPENDATA_RENDER__.update())}var Nt={};function It(t){if(t.origin===l){var e,n,r;try{e=JSON.parse(t.data)}catch(t){}e&&Nt[e.type]&&(n=document.querySelectorAll("ww-open-data iframe"),r=function(n){n.contentWindow===t.source&&Nt[e.type](t,e,n)},Array.prototype.forEach.call(n,r))}}Nt["ww.opendata.event"]=function(t,e,n){"click"===e.eventType&&n.parentNode.click()},Nt["ww.opendata.resize"]=function(t,e,n){var r=e.size;n.style.width=r.width,n.style.height=r.height,w("update",{el:n.parentNode,hasData:!!r.width})};var Lt=tt&&new tt;function Jt(t){var e=et(Lt,t);if(e)return e;try{var n=rt(t,{mode:"closed"});return nt(Lt,t,n),n}catch(t){w("error",t)}}var Ht=[],Ut=null;function zt(t){if(t&&t.getAttribute){var e=t.getAttribute("type");if(e){var n=t.getAttribute("openid");if(n){var r=t.getAttribute("corpid"),i=Jt(t);if(i){var o=st(e,n,r);if(o){var a=at(o,"data");if(it(i,a||""),w("update",{element:t,hasData:!!a}),a)return}Ht.indexOf(t)<0&&Ht.push(t),Ut||(Ut=setTimeout(b("bindPending",Kt),20))}}}}}function Kt(){var t=Ht;Ut=null,Ht=[];var e=[],n={};U(t,(function(t){var r=t.getAttribute("type");if(r){var i=t.getAttribute("openid");if(i){var o=t.getAttribute("corpid"),a=dt(r,i,o);n[a]||(n[a]=!0,e.push({type:r,id:i,corpid:o}))}}})),e.length&&ft(e,(function(e){e?w("error",e):U(t,(function(t){var e=Jt(t),n=t.getAttribute("type");if(n){var r=t.getAttribute("openid");if(r){var i=st(n,r,t.getAttribute("corpid"));if(i){var o=at(i,"data");it(e,o||""),w("update",{element:t,hasData:!!o})}}}}))}))}var Bt=0;rt||(Bt|=1);var Vt=b("bind",Bt?qt:zt),Xt=b("bindAll",Bt?function(t){Array.prototype.forEach.call(t,qt)}:function(t){U(t,zt)});if(_("[renderer] #"+Bt),Bt&&function(){window.addEventListener?window.addEventListener("message",b("dispatchMessage",It)):window.attachEvent("onmessage",b("dispatchMessage",It));var t=document.querySelector("head");Mt=document.createElement("style"),t.appendChild(Mt),Ft=new Wt,t.appendChild(Ft.iframe);var e=Mt.sheet;e.insertRule("ww-open-data {\n    display: inline-block;\n    vertical-align: text-bottom;\n    overflow: hidden;\n  }",0),e.insertRule("ww-open-data img {\n    display: block;\n    width: 100%;\n    height: 100%;\n  }",1),e.insertRule("ww-open-data iframe {\n    display: block;\n    width: 0;\n    height: 0;\n  }",2)}(),!window.WWOpenData){var Gt={};I(Gt,"bindAll",{value:Xt,enumerable:!0}),I(Gt,"bind",{value:Vt,enumerable:!0}),I(Gt,"on",{value:m,enumerable:!0}),I(Gt,"once",{value:function(t,e){m(t,(function t(n){g("name",t),e(n)}))},enumerable:!0}),I(Gt,"off",{value:g,enumerable:!0}),I(Gt,"report",{value:function(){E("Sentry report")},enumerable:!0}),I(Gt,"checkSession",{value:function(t){void 0===t&&(t={}),function(t,e){var n={errMsg:"checkSession:ok"};null==e.success||e.success(n),null==e.complete||e.complete(n)}(0,t)},enumerable:!0}),I(Gt,"initCanvas",{value:function(){var t;if(Dt)return!0;var e=null==(t=window.CanvasRenderingContext2D)?void 0:t.prototype;return!!e&&(e.strokeText=function(t,e,n,r){if(!vt)return null==r?Z(this,t,e,n):Z(this,t,e,n,r);var i=At(t);return i!==t&&Tt(this),null==r?Z(this,i,e,n):Z(this,i,e,n,r)},e.fillText=function(t,e,n,r){if(!vt)return null==r?Q(this,t,e,n):Q(this,t,e,n,r);var i=At(t);return i!==t&&Tt(this),null==r?Q(this,i,e,n):Q(this,i,e,n,r)},e.measureText=function(t){return $(this,vt?At(t):t)},Dt=!0,!0)},enumerable:!0}),I(Gt,"enableCanvasSharing",{value:function(){kt=!0},enumerable:!0}),I(Gt,"disableCanvasSharing",{value:function(){kt=!1},enumerable:!0}),I(Gt,"prefetch",{value:function(t,e){var n=t.items;ft(n,(function(t){if(t)return e(t);var r=[];U(n,(function(t){var e=st(t.type,t.id,t.corpid);e&&1===at(e,"datakind")&&r.push({type:t.type,id:t.id,corpid:t.corpid,data:Ot(e)})})),function(t){vt?t():yt?t(yt):mt.push(t)}((function(t){t?e(t):e(null,{items:r})}))}))},enumerable:!0}),I(Gt,"__version__",{value:"wwopendata.js@210224-173244-188"}),I(Gt,"__callback__",{value:b("callback",(function(t,e){var n=at(ct,t);if(delete ct[t],n)if(e){var r=at(e,"items");r?(U(r,(function(t){var e=at(t,"type"),n=at(t,"id"),r=at(t,"corpid");ut(pt,dt(e,n,r),t)})),n(null,e)):n(new Error("Fetch data failed, missing items"))}else n(new Error("Fetch data failed, missing response"))}))}),I(Gt,"__secret__",{value:"__WW_OPEN_DATA_SECRET_VALUE__"}),I(Gt,"initJSSDK",{value:b("initJSSDK",(function(t){D=t}))}),I(window,"WWOpenData",{value:Gt,enumerable:!0})}if("customElements"in window&&!customElements.get("ww-open-data"))try{var Qt=function(t){var n,r,i,o;function a(){var e;return Yt(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e=t.call(this)||this)),e}return r=t,(n=a).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,a.prototype.attributeChangedCallback=function(){this._current.type===this.getAttribute("type")&&this._current.id===this.getAttribute("openid")&&this._current.corpid===this.getAttribute("corpid")||Yt(this)},i=a,o=[{key:"observedAttributes",get:function(){return["type","openid","corpid"]}}],null&&e(i.prototype,null),o&&e(i,o),a}(a(HTMLElement));customElements.define("ww-open-data",Qt)}catch(h){S(h,"register custom element")}function Yt(t){t._current={type:t.getAttribute("type"),id:t.getAttribute("openid"),corpid:t.getAttribute("corpid")},Vt(t)}}catch(h){t.captureException(h,"?")}}();